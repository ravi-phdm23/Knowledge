import streamlit as st
import pandas as pd
import tempfile
from Excel_Regression_Dashboard_automation import main

st.title("Regression Dashboard Excel Creation")

template_file     = st.file_uploader("Excel Template Path:", type=["xlsx", "xlsm"])
consol_file       = st.file_uploader("Consol Workbook Template Path:", type=["xlsx", "xlsm"])
output_file       = st.file_uploader("Output Folder:", type=["xlsx", "xlsm"])

if st.button("Create Excel Dashboards"):
    if not template_file or not consol_file or not output_file:
        st.error("Please upload all required files.")
    else:
        # Save files to temp paths
        with tempfile.NamedTemporaryFile(delete=False, suffix=".xlsm") as tf1:
            tf1.write(template_file.read())
            template_path = tf1.name

        with tempfile.NamedTemporaryFile(delete=False, suffix=".xlsm") as tf2:
            tf2.write(consol_file.read())
            consol_path = tf2.name

        with tempfile.NamedTemporaryFile(delete=False, suffix=".xlsm") as tf3:
            tf3.write(output_file.read())
            output_path = tf3.name

        # Call your main function with file paths
        main(template_path, output_path, consol_path)

        st.success("Excel Dashboard created successfully.")
